<html layout:decorate="~{layout}">
<head>
<meta charset="UTF-8">

<title>ì•„í‹°í´</title>


<style>
    footer{
        position: static !important;
    }
</style>

<link rel="stylesheet" type="text/css" th:href="@{http://localhost:8080/css/index.css}"/>
<link rel="stylesheet" type="text/css" th:href="@{http://localhost:8080/css/bbsYj/articleYj.css}"/>
<link rel="icon" type="image/png" th:href="@{http://localhost:8080/image/ë¡œê³ .png}"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous"/>
<link rel="stylesheet" href="https://kit.fontawesome.com/1f0cefbb8e.css" crossorigin="anonymous">
<script src="https://kit.fontawesome.com/1f0cefbb8e.js" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ë²„íŠ¼ ìƒíƒœ ì„¤ì •
    document.addEventListener('DOMContentLoaded', function() {
        var homeButton = document.querySelector('#btnradio1');
        var reviewButton = document.querySelector('#btnradio2');

        if (window.location.hash === '#review') {
            // ë¦¬ë·° ë²„íŠ¼ì´ ì„ íƒëœ ìƒíƒœë¡œ ì´ˆê¸°í™”
            reviewButton.checked = true;
            showReviewContent();
        } else {
            // í™ˆ ë²„íŠ¼ì´ ì„ íƒëœ ìƒíƒœë¡œ ì´ˆê¸°í™”
            homeButton.checked = true;
            showHomeContent();
        }

        // ë²„íŠ¼ í´ë¦­ ì‹œ í•´ì‹œ ë³€ê²½
        homeButton.addEventListener('click', function() {
            window.location.hash = '#home';
            showHomeContent();
        });

        reviewButton.addEventListener('click', function() {
            window.location.hash = '#review';
            showReviewContent();
        });
    });

    // í™ˆ ë‚´ìš© í‘œì‹œ í•¨ìˆ˜
    function showHomeContent() {
        document.querySelector('.yj-img').style.display = 'block';
        document.querySelector('.yj-img2').style.display = 'none';
        // ë©¤ë²„ ëª©ë¡ì„ ë³´ì´ê²Œ í•©ë‹ˆë‹¤.
        document.querySelector('.meet-members').style.display = 'block';
    }

    // ë¦¬ë·° ë‚´ìš© í‘œì‹œ í•¨ìˆ˜
    function showReviewContent() {
        document.querySelector('.yj-img').style.display = 'none';
        document.querySelector('.yj-img2').style.display = 'block';
        // ë©¤ë²„ ëª©ë¡ì„ ìˆ¨ê¹ë‹ˆë‹¤.
        document.querySelector('.meet-members').style.display = 'none';
    }

    document.addEventListener('DOMContentLoaded', function() {

        var joinButton = document.querySelector('.join-button');
        
            joinButton.addEventListener('click', function() {
            alert('ê°€ì… ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
            });



        // var joinForm = document.getElementById('joinForm');
        // var joinButton = document.getElementById('joinButton');
        
        // joinButton.addEventListener('click', function(event) {
        //     event.preventDefault(); // ê¸°ë³¸ ì´ë²¤íŠ¸ ë™ì‘ ë°©ì§€ (í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ë°©ì§€)

        //     joinForm.submit(); // í¼ì„ ì„œë²„ë¡œ ì œì¶œ
        // });

        var reviewForm = document.querySelector('.review-form');
        var reviewWriteButton = document.querySelector('.review-write');
        var cancelButton = document.querySelector('#cancel-review');

        reviewWriteButton.addEventListener('click', function() {
            if (reviewForm.style.display === 'block') {
                reviewForm.style.display = 'none';
            } else {
                reviewForm.style.display = 'block';
            }
        });

        document.querySelector('#submit-review').addEventListener('click', function(e) {
        e.preventDefault(); // ê¸°ë³¸ ì´ë²¤íŠ¸ ë™ì‘ ë°©ì§€ (í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ë°©ì§€)

            var meetListNum = document.querySelector('#meet-listnum').value;
            var reviewContent = document.querySelector('#review-content').value;
            var reviewImage = document.querySelector('#review-image').files[0];

            // ë¦¬ë·° ë‚´ìš©ê³¼ ì´ë¯¸ì§€ ëª¨ë‘ í•„ìˆ˜ë¡œ ì…ë ¥ë˜ì–´ì•¼ í•¨
            if (reviewContent.trim() === '' && !reviewImage) {
                alert('ë‚´ìš©ê³¼ ì´ë¯¸ì§€ë¥¼ ëª¨ë‘ ì‘ì„±í•´ì£¼ì„¸ìš”.');
            } else if (!reviewImage) {
                alert('ì´ë¯¸ì§€ë¥¼ ì²¨ë¶€í•´ì£¼ì„¸ìš”.');
            } else if (reviewContent.trim() === '') {
                alert('ë‚´ìš©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.');
            } else {
                // ì´ë¯¸ì§€ íŒŒì¼ì„ FormDataì— ì¶”ê°€
                var formData = new FormData();
                formData.append('meetListNum', meetListNum);
                formData.append('meetReviewContent', reviewContent);
                formData.append('meetReviewImg', reviewImage);

                // ì„œë²„ë¡œ ë°ì´í„° ì „ì†¡ (AJAXë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ë¡œ POST ìš”ì²­ ë³´ë‚´ê¸°)
                $.ajax({
                    url: '/upload-review',
                    type: 'POST',
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function(response) {
                        alert('ë¦¬ë·°ê°€ ê²Œì‹œë˜ì—ˆìŠµë‹ˆë‹¤.');
                        document.querySelector('#review-content').value = '';
                        document.querySelector('#review-image').value = ''; // ì´ë¯¸ì§€ íŒŒì¼ ì„ íƒ ì´ˆê¸°í™”

                        // ì—¬ê¸°ì„œ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        window.location.reload();
                    },
                    error: function(xhr, status, error) {
                        alert('ì˜¤ë¥˜ ë°œìƒ: ' + status);
                    }
                });
            }
        });


        
    });

// ëª¨ë‹¬ ì°½ ì—´ê¸°
function openModal(imgElement) {
        // ëª¨ë‹¬ ì°½ ì—˜ë¦¬ë¨¼íŠ¸ ìƒì„±
        var modal = document.createElement('div');
        modal.className = 'modal';
        
        // ëª¨ë‹¬ ì´ë¯¸ì§€ ì—˜ë¦¬ë¨¼íŠ¸ ìƒì„±
        var modalImg = document.createElement('img');
        modalImg.className = 'modal-content';
        modalImg.src = imgElement.src;
        
        // ëª¨ë‹¬ ì°½ì— ì´ë¯¸ì§€ ì¶”ê°€
        modal.appendChild(modalImg);
        
        // ëª¨ë‹¬ ì°½ ìŠ¤íƒ€ì¼ ì„¤ì •
        modal.style.display = 'block';
        
        // ëª¨ë‹¬ ì°½ì„ bodyì— ì¶”ê°€
        document.body.appendChild(modal);
        
        // ëª¨ë‹¬ ì°½ì„ í´ë¦­í•˜ë©´ ë‹«íˆë„ë¡ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€
        modal.onclick = function() {
            modal.style.display = 'none';
            modal.remove(); // ëª¨ë‹¬ ì°½ ì œê±°
        };
    }
    

</script>

</head>
<body>

<div layout:fragment="content">






    

    <div class="text-center">
        <div class="btn-group" role="group" aria-label="Basic radio toggle button group" style="width: 800px; margin-bottom: 5px; margin-top: 20px;">
            <!-- í™ˆ ë²„íŠ¼ -->
            <input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off" checked>
            <label class="btn btn-custom" for="btnradio1" onclick="showHomeContent()">
                <span style="color: black;">í™ˆ</span>
                <div class="underline"></div> <!-- ë°‘ì¤„ ìš”ì†Œ ì¶”ê°€ -->
            </label>
            <!-- ë¦¬ë·° ë²„íŠ¼ -->
            <input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off">
            <label class="btn btn-custom" for="btnradio2" onclick="showReviewContent()">
                <span style="color: black;">ë¦¬ë·°</span>
                <div class="underline"></div> <!-- ë°‘ì¤„ ìš”ì†Œ ì¶”ê°€ -->
            </label>
        </div>
    </div>

    <div class="container">
        <div class="row justify-content-end">
            <div class="col-8 mx-2 fixed-width-col" th:each="meetListInfo : ${meetListInfo}">
    
                <div class="yj-img">
                    <img th:src="@{${'/image/gatchiImage/' + meetListInfo.meetImage}}" alt="në²ˆë°©ì˜ ëŒ€í‘œì‚¬ì§„">
                    <div class="Main_content" >
                        <div class="round-image">
                            <img th:src="@{/image/gatchiImage/1111.jpg}" alt="ë°©ì¥í”„ì‚¬(ì„ì˜)"/>
                        </div>
                        <p class="Yj-master">ê¹€ëª…ë€</p>
                        <p class="Yj-title" th:text="${meetListInfo.meetTitle}"></p>
                    </div>
                    <div class="main-text">
                        <p class="Yj-text1" th:text="${meetListInfo.meetContent}"></p>

                        <div class="yj-info">ìƒì„¸ ì •ë³´</div>
                        <p class="text-with-hyphen Yj-text2" th:text="${meetListInfo.meetPlace}"></p>
                        <p class="text-with-hyphen Yj-text2" th:text="${meetListInfo.meetDday}"></p>

                        <div class="yj-inwon">ëª¨ì§‘ ì¸ì›</div>
                        <div class="text-container">
                            <p class="Yj-text3" th:text="${meetListInfo.meetMemCnt}"></p>/
                            <p class="Yj-text3" th:text="${meetListInfo.meetMaxMemCnt}"></p>
                        </div>
                        <!-- <button class="join-button">
                            <span class="icon" id="joinButton">ğŸ“</span> ê°€ì…í•˜ê¸°
                        </button> -->
                        <!-- <form id="joinForm" method="post" action="/join-meet">
                            <input type="hidden" name="meetListNum" id="meetListNum" th:value="${meetListNum}"/>
                            <button class="join-button" type="submit" id="joinButton">
                                <span class="icon" id="joinButton">ğŸ“</span>ê°€ì…í•˜ê¸°
                            </button>
                        </form> -->
                        <form action="/join-meet" method="post">
                            <input type="hidden" name="meetListNum" th:value="${meetListNum}"/>
                            <button type="submit" class="join-button">
                                <span class="icon" id="joinButton">ğŸ“</span>ê°€ì…í•˜ê¸°
                            </button>
                        </form>
                        
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="meet-members">
                    <p style=" text-align: center;">
                        <span style="margin-right: 30px;">ë©¤ë²„ëª©ë¡</span>
                        <a th:href="@{'/managerYj.action?meetListNum=' + ${meetListInfo.meetListNum}}" style="text-decoration: none;">
                            <span style="color: #adadad;">ê´€ë¦¬</span>
                            <i class="fa-solid fa-gear fa-sm" style="color: #adadad; vertical-align: 0px;"></i>
                        </a>
                    </p>
                    <div class="meet-mem-list" th:each="meetMember : ${meetMembers}">
                        <li class="round-image-rev mt-2" style="margin-right: 10px; margin-left: -10px;">
                            <img th:src="@{/image/gatchiImage/1111.jpg}" alt="ìœ ì €í”„ì‚¬(ì„ì˜)"/>
                        </li>
                            <li class="custom-li" th:text="${meetMember}"></li>
                    </div>
                </div>
            </div>
        </div>


    </div>

    <div class="yj-img2">
        <div class="review-title">REVIEW</div>
        <div class="review-sub">ì´ ëª¨ì„ ìœ ì €ì˜ ìƒìƒí•œ í›„ê¸°ë¥¼ ë§Œë‚˜ë³´ì„¸ìš”!</div>
        <div class="review-write">ì‘ì„±í•˜ê¸°</div>
        <form action="/upload-review" method="POST" enctype="multipart/form-data">
        <div class="review-form" style="display: none;">
            <div class="review-input">
                <textarea name="meetReviewContent" id="review-content" placeholder=" ë¦¬ë·°ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”."></textarea>
                <input type="file" name="meetReviewImg" id="review-image" accept="image/*">
                <input type="hidden" id="meet-listnum" name="meetListNum" th:value="${meetListNum}" />
                <button id="submit-review">ë“±ë¡í•˜ê¸°</button>
            </div>
        </div>
        </form>
        <div class="d-flex justify-content-center mb-4" th:each="meetReview : ${meetReview}">
            <div class="card" style="width: 36rem; margin-bottom: 20px; border:none;">
                <div class="card-body">
                    <div class="d-flex flex-column mb-2">
                        <div class="round-image-rev mt-2">
                            <img th:src="@{/image/gatchiImage/1111.jpg}" alt="ìœ ì €í”„ì‚¬(ì„ì˜)"/>
                        </div>
                        <p class="memid" th:text="${meetReview.email}"></p>
                        <div class="col-md-4 mx-auto" style="width: 300px; height: 300px; overflow: hidden; border-radius: 5px; margin-bottom: 10px; margin-top: 10px;">
                            <img th:src="@{${'/image/reviewImage/' + meetReview.meetReviewImg}}" class="img-fluid rounded-start" alt="ë¦¬ë·°ì‚¬ì§„" style="width: 100%; height: 100%; object-fit: cover; cursor: pointer;" onclick="openModal(this);">
                        </div>
                    </div>
                    <p class="card-text" th:text="${meetReview.meetReviewContent}" style="padding-left: 10px; padding-right: 10px; text-align: justify; font-size: 18px; margin-bottom: 5px;"></p>
                    <p class="card-text" th:text="${meetReview.meetReviewDate}" style="color: #AAAAAA; font-size: 13px; position: absolute; top: 0; right: 0; margin-top: 31px; margin-right: 20px;"></p>
                </div>
            </div>
        </div>
    </div>






        
</div>

</body>
</html>