<html layout:decorate="~{layout}">
<head>
<meta charset="UTF-8">

<title>ÏïÑÌã∞ÌÅ¥</title>


<style>
    footer{
        position: static !important;
    }
</style>

<link rel="stylesheet" type="text/css" th:href="@{http://localhost:8080/css/index.css}"/>
<link rel="stylesheet" type="text/css" th:href="@{http://localhost:8080/css/challenge/challengeArticle.css}"/>
<link rel="icon" type="image/png" th:href="@{http://localhost:8080/image/Î°úÍ≥†.png}"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous"/>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://kit.fontawesome.com/171f74c68f.js" crossorigin="anonymous"></script>


<script>

    // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞ Î≤ÑÌäº ÏÉÅÌÉú ÏÑ§Ï†ï
    document.addEventListener('DOMContentLoaded', function() {
        var homeButton = document.querySelector('#btnradio1');
        var reviewButton = document.querySelector('#btnradio2');

        if (window.location.hash === '#review') {
            // Î¶¨Î∑∞ Î≤ÑÌäºÏù¥ ÏÑ†ÌÉùÎêú ÏÉÅÌÉúÎ°ú Ï¥àÍ∏∞Ìôî
            reviewButton.checked = true;
            showReviewContent();
        } else {
            // Ìôà Î≤ÑÌäºÏù¥ ÏÑ†ÌÉùÎêú ÏÉÅÌÉúÎ°ú Ï¥àÍ∏∞Ìôî
            homeButton.checked = true;
            showHomeContent();
        }

        // Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú Ìï¥Ïãú Î≥ÄÍ≤Ω
        homeButton.addEventListener('click', function() {
            window.location.hash = '#home';
            showHomeContent();
        });


});

    // Ìôà ÎÇ¥Ïö© ÌëúÏãú Ìï®Ïàò
    function showHomeContent() {
        document.querySelector('#homeAndreviw').classList.remove('reviwAndhome');
        document.querySelector('.yj-img').style.display = 'block';
        document.querySelector('.yj-img2').style.display = 'none';
        document.querySelector('.meet-members').style.display = 'block';
        document.querySelector('.meet-mypage').style.display = 'block';
    }

    // Î¶¨Î∑∞ ÎÇ¥Ïö© ÌëúÏãú Ìï®Ïàò
    function showReviewContent() {
        document.querySelector('#homeAndreviw').classList.add('reviwAndhome');
        document.querySelector('.yj-img').style.display = 'none';
        document.querySelector('.yj-img2').style.display = 'block';
        document.querySelector('.meet-members').style.display = 'none';
        document.querySelector('.meet-mypage').style.display = 'none';
    }


    document.addEventListener('DOMContentLoaded', function() {

        var reviewForm = document.querySelector('.review-form');
        var reviewWriteButton = document.querySelector('.review-write');

        reviewWriteButton.addEventListener('click', function() {
            if (reviewForm.style.display === 'block') {
                reviewForm.style.display = 'none';
            } else {
                reviewForm.style.display = 'block';
            }
            
        });

        //Î¶¨Î∑∞ Îì±Î°ù
    document.querySelector('#submit-review').addEventListener('click', function(e) {
        e.preventDefault(); // Í∏∞Î≥∏ Ïù¥Î≤§Ìä∏ ÎèôÏûë Î∞©ÏßÄ (ÌéòÏù¥ÏßÄ ÏÉàÎ°úÍ≥†Ïπ® Î∞©ÏßÄ)
        
            var challengeListNum = document.querySelector('#challengeListNum').value;
            var challengeAuthContent= document.querySelector('#challengeAuthContent').value;
            var challengeAuthImage = document.querySelector('#challengeAuthImage').files[0];
            
            challengeAuthContent = challengeAuthContent.replace(/\n/g, '\n');
            
            // Î¶¨Î∑∞ ÎÇ¥Ïö©Í≥º Ïù¥ÎØ∏ÏßÄ Î™®Îëê ÌïÑÏàòÎ°ú ÏûÖÎ†•ÎêòÏñ¥Ïïº Ìï®
            if (challengeAuthContent.trim() === '' && !challengeAuthImage) {
                alert('ÎÇ¥Ïö©Í≥º Ïù¥ÎØ∏ÏßÄÎ•º Î™®Îëê ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî.');
            } else if (!challengeAuthImage) {
                alert('Ïù¥ÎØ∏ÏßÄÎ•º Ï≤®Î∂ÄÌï¥Ï£ºÏÑ∏Ïöî.');
            } else if (challengeAuthContent.trim() === '') {
                alert('ÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî.');
            } else {
                // Ïù¥ÎØ∏ÏßÄ ÌååÏùºÏùÑ FormDataÏóê Ï∂îÍ∞Ä
                var formData = new FormData();
                formData.append('challengeListNum', challengeListNum);
                formData.append('challengeAuthContent', challengeAuthContent);
                formData.append('challengeAuthImage', challengeAuthImage);


                $.ajax({
                    url: '/uploadAuth',
                    method: 'POST',
                    data: formData,
                    processData: false, // ÌïÑÏàò: formData Ï≤òÎ¶¨ ÎπÑÌôúÏÑ±Ìôî
                    contentType: false, // ÌïÑÏàò: ÏΩòÌÖêÏ∏† ÌÉÄÏûÖ ÎπÑÌôúÏÑ±Ìôî
                    success: function(response) {
                        if (response === 'success') {
                            alert('Î¶¨Î∑∞Í∞Ä Í≤åÏãúÎêòÏóàÏäµÎãàÎã§.');
                          // Ïù¥ÎØ∏ÏßÄ ÌååÏùº ÏÑ†ÌÉù Ï¥àÍ∏∞Ìôî
                          location.reload();
                           
                        } else if (response === 'already-reviewed') {
                            alert('Ïù¥ÎØ∏ Î¶¨Î∑∞Î•º ÏûëÏÑ±ÌïòÏÖ®ÏäµÎãàÎã§.');
                            
                        }
                    },
                    error: function(xhr, status, error) {
                        alert('Ïò§Î•ò Î∞úÏÉù: ' + status);
                    }
                });

            }
            
        });
    });


    //Î¶¨Î∑∞ Ïù∏Ï¶ùÌïòÍ∏∞
    function confirmReview(challengeListNum,challengeAuthImage) {

        var ok = 'confirm' + challengeAuthImage;
        var now = 'now'+ challengeAuthImage;
        var select = 'selectAuth' + challengeAuthImage;

        if (confirm('Ïù∏Ï¶ùÏùÑ ÏäπÏù∏ÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
            $.ajax({
                type: "POST",
                url: "/confirmReview.action",
                data: {
                    challengeListNum: challengeListNum,
                    challengeAuthImage: challengeAuthImage
                },
                success: function (response) {
                    alert('ÏäπÏù∏ÎêòÏóàÏäµÎãàÎã§.');
                    document.getElementById(ok).style.display = "block";
                    document.getElementById(select).style.display = "none";
                    document.getElementById(now).style.display = "none";
                },
                error: function () {
                    alert('ÏäπÏù∏Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                }
            });
        }
    }

    //Î¶¨Î∑∞ Í±∞Î∂ÄÌïòÍ∏∞
    function failReview(challengeListNum,challengeAuthImage) {

        var no = 'fail' + challengeAuthImage;
        var now = 'now'+ challengeAuthImage;
        var select = 'selectAuth' + challengeAuthImage;

        if (confirm('Ïù∏Ï¶ùÏùÑ Í±∞Î∂ÄÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
            $.ajax({
                type: "POST",
                url: "/failReview.action",
                data: {
                    challengeListNum: challengeListNum,
                    challengeAuthImage: challengeAuthImage
                },
                success: function (response) {
                    alert('Í±∞Î∂ÄÎêòÏóàÏäµÎãàÎã§.');
                    document.getElementById(no).style.display = "block";
                    document.getElementById(select).style.display = "none";
                    document.getElementById(now).style.display = "none";
                
                },
                error: function () {
                    alert('Í±∞Î∂ÄÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                }
            });
        }
    }

    // Î™®Îã¨ Ï∞Ω Ïó¥Í∏∞
    function openModal(imgElement) {
        // Î™®Îã¨ Ï∞Ω ÏóòÎ¶¨Î®ºÌä∏ ÏÉùÏÑ±
        var modal = document.createElement('div');
        modal.className = 'modal';
        
        // Î™®Îã¨ Ïù¥ÎØ∏ÏßÄ ÏóòÎ¶¨Î®ºÌä∏ ÏÉùÏÑ±
        var modalImg = document.createElement('img');
        modalImg.className = 'modal-content';
        modalImg.src = imgElement.src;
        
        // Î™®Îã¨ Ï∞ΩÏóê Ïù¥ÎØ∏ÏßÄ Ï∂îÍ∞Ä
        modal.appendChild(modalImg);
        
        // Î™®Îã¨ Ï∞Ω Ïä§ÌÉÄÏùº ÏÑ§Ï†ï
        modal.style.display = 'block';
        
        // Î™®Îã¨ Ï∞ΩÏùÑ bodyÏóê Ï∂îÍ∞Ä
        document.body.appendChild(modal);
        
        // Î™®Îã¨ Ï∞ΩÏùÑ ÌÅ¥Î¶≠ÌïòÎ©¥ Îã´ÌûàÎèÑÎ°ù Ïù¥Î≤§Ìä∏ Ìï∏Îì§Îü¨ Ï∂îÍ∞Ä
        modal.onclick = function() {
            modal.style.display = 'none';
            modal.remove(); // Î™®Îã¨ Ï∞Ω Ï†úÍ±∞
        };
    }

    


    //Î¶¨Î∑∞ÏÇ≠Ï†ú
    function deleteReview(email, challengeListNum, challengeAuthListNum ,challengeAuthImage) {
        if (confirm('Î¶¨Î∑∞Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
            $.ajax({
                type: "POST",
                url: "/deleteChallengeReview",
                data: {
                    challengeListNum: challengeListNum,
                    challengeAuthListNum: challengeAuthListNum,
                    email: email,
                    challengeAuthImage: challengeAuthImage
                },
                success: function (response) {
                    alert('ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.');
                    location.reload();
                },
                error: function () {
                    alert('ÏÇ≠Ï†úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
                }
            });
        }
    }

    //Ï±åÎ¶∞ÏßÄ Í∞ÄÏûÖ
    function joinChallenge() {
        if (confirm('Ï±åÎ¶∞ÏßÄÏóê Í∞ÄÏûÖÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
            document.getElementById('joinChallengeForm').submit();
            alert('Ï±åÎ¶∞ÏßÄÏóê Í∞ÄÏûÖÎêòÏóàÏäµÎãàÎã§!')
        }
    }
    //Ï±åÎ¶∞ÏßÄ ÏÇ≠Ï†ú
    function deleteChallenge() {
        if (confirm('Ï±åÎ¶∞ÏßÄÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
            document.getElementById('deleteChallengeForm').submit();
            alert('Ï±åÎ¶∞ÏßÄÏóê ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§!')
        }
    }
    //Ï±åÎ¶∞ÏßÄ Ìè¨Í∏∞
    function giveUpChallenge() {
        if (confirm('Ï±åÎ¶∞ÏßÄÎ•º Ìè¨Í∏∞ÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
            document.getElementById('giveUpChallengeForm').submit();
            alert('Ï±åÎ¶∞ÏßÄÎ•º Ìè¨Í∏∞ÌïòÏòÄÏäµÎãàÎã§!')
        }
    }

    function chatRoom(){
    let challengeListNum = document.getElementById('challengeListNum').value;

    var options = 'width=600px,height=700px,scrollbars=yes'
            popupChat = window.open("articleChallengeChatRoom.action?challengeListNum=" + challengeListNum,"_blacnk",options);
}

// Îã¨ÏÑ±Î•† ÌëúÏãú
$(document).ready(function() {
        $('#countdown-wrap').each(function() {
            var currentAmount = parseInt($(this).find('#current-amount').text());
            var maxAmount = parseInt($(this).find('#max-amount').text());

            var percentage = Math.floor((currentAmount / maxAmount) * 100);
            
            var progressBar = $(this).find('#progress');
            progressBar.css('width', percentage + '%');
            progressBar.css('background-color', '#1d65b2');

            var percentElement = $(this).find('#goal');
            percentElement.text(percentage + "%");
        });
    });


setInterval(checkNotReadMessage, 700);

function checkNotReadMessage(){

    let user = {'userId': "article"};

    let requestOption = {
        method:'POST',
        headers:{
            'Content-Type':'application/json',
        },
        body:JSON.stringify(user)
    };

    fetch('/chat/checkNotReadMessage', requestOption)
      .then(response => response.json())
      .then(data => {
        // Í∞ÄÏ†∏Ïò® Ïà´ÏûêÎ•º ÌôîÎ©¥Ïóê ÌëúÏãú
        //console.log("Îç∞Ïù¥ÌÉÄ : " + JSON.stringify(data));
        // console.log("checkNotReadMessage : " + JSON.stringify(data));
        roomsNotReadMessage(data);
      })
      .catch(error => {
        console.error('Ïà´Ïûê ÏóÖÎç∞Ïù¥Ìä∏ Ï§ë Ïò§Î•ò Î∞úÏÉù:', error);
      });
}


function roomsNotReadMessage(data){
    let rooms = document.getElementsByName("room");
    let notReadCountObject = data.notReadCount;
    let notReadCountKeys = Object.keys(notReadCountObject);
    let notReadCountSize = notReadCountKeys.length;

    // console.log("ÌÅ¨Í∏∞ : " + notReadCountSize);
    // console.log(rooms[0].getAttribute('data-value'));
    // console.log("ÏúÑÏûâ : " + notReadCountKeys);

    for(let i=0; i<notReadCountSize; i++){
        for(let j=0; j<rooms.length; j++){
            let roomId = rooms[j].getAttribute('data-value');
            console.log(rooms[j].getAttribute('data-value'));
            let notReadCountValue = notReadCountObject[roomId];
            if(notReadCountValue <= 0){
                continue;
            }
            rooms[j].textContent = notReadCountValue;
        }
    }
}

</script>
<style>
tr{
    text-align: center;
}

            tr:first-child td {
            font-size: 18px;
            vertical-align: middle;
            width: 300px;
            height: 50px;
            border-bottom: #c8c8c8 solid 4px;
        }

        /* 2ÌñâÏùò ÎÜíÏù¥ Ïä§ÌÉÄÏùº */
        tr:last-child {
            height: 200px;
        }

        /* ÌÖåÏù¥Î∏î ÌÖåÎëêÎ¶¨ Ï†úÍ±∞ */
        table {
            border-collapse: separate;
    border-spacing: 20px; 
            align-self: center;
            border: 0px ;
            
        }

#challengeAuthContent {
    width: 71%;
    margin-bottom: 10px;
    height: 100px;
}

.badge.challenge {
    background-color: red;
  }

  .finish-button {
    display: inline-block;
    padding: 8px 18px;
    font-size: 18px;
    background-color: #b3b3b3;
    color: #fff;
    border: none;
    border-radius: 10px;
    box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
    transition: background-color 0.15s ease;
    margin-right: 10px;
}
.square {
      width: 40px;
      height: 40px;
      margin: 3px;
      border-radius: 20%;
      display: inline-block;
    }
.green {
    background-color: rgb(22, 222, 22);
}

.gray {
    background-color: rgb(222, 222, 222);
}
</style>
</head>
<body>

<div layout:fragment="content">

    <div class="text-center">
        <div class="btn-group" id="homeAndreviw" role="group" aria-label="Basic radio toggle button group">
            <!-- Ìôà Î≤ÑÌäº -->
            <input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off" checked>
            <label class="btn btn-custom" for="btnradio1" onclick="showHomeContent()">
                <span style="color: black;">Ìôà</span>
                <div class="underline"></div> <!-- Î∞ëÏ§Ñ ÏöîÏÜå Ï∂îÍ∞Ä -->
            </label>
            <!-- Î¶¨Î∑∞ Î≤ÑÌäº -->
            <input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off">
            <label class="btn btn-custom" for="btnradio2" onclick="showReviewContent()">
                <span style="color: black;">Ïù∏Ï¶ùÌïòÍ∏∞</span>
                <div class="underline"></div> <!-- Î∞ëÏ§Ñ ÏöîÏÜå Ï∂îÍ∞Ä -->
            </label>
           
        </div>
    </div>

    <div class="container">
        <div class="row justify-content-end homeaticle">

            <div class="col-md-2" id="mypage">
                <div class="meet-mypage">
                    <div class="badge challenge" th:text="challenge"></div>
                

                    <div class="user-info-container">
                            <div class="round-image-login" th:if="${#httpSession.getAttribute('user') != null}">
                                <img th:src="@{${session.user.picture}}">
                            </div>
                            <div class="round-image-login" th:if="${#httpSession.getAttribute('user1') != null}">
                                <img th:src="@{image/login/__${session.user1.picture}__}">
                            </div>
                        <div class="login-user-email" th:if="${#httpSession.getAttribute('user1') != null}" 
                        th:text="|${session.user1.name}"></div>
                        <div class="login-user-email" th:if="${#httpSession.getAttribute('user') != null}" 
                        th:text="|${session.user.name}"></div>
                        <div style="font-size: 17px; margin-top: 3px;">Îãò</div>
                        <div th:if="${meetMemStatus == 1}" style="margin-left: 30px; color: #adadad; font-size: 17px;">üëë</div>
                        <div th:if="${ChallengeMemberStatus == 1}" style="margin-left: 2px; color: #adadad; font-size: 17px; margin-top: 3px;">Î∞©Ïû•</div>
                        <div th:if="${ChallengeMemberStatus == 2}" style="margin-left: 30px; color: #adadad; font-size: 17px; margin-top: 3px;">ü§ó</div>
                        <div th:if="${ChallengeMemberStatus == 2}" style="margin-left: 2px; color: #adadad; font-size: 17px; margin-top: 3px;">ÌöåÏõê</div>
                        <div th:if="${ChallengeMemberStatus == 0}" style="margin-left: 30px; color: #adadad; font-size: 17px;">‚åõ</div>
                        <div th:if="${ChallengeMemberStatus == 0}" style="margin-left: 2px; color: #adadad; font-size: 17px; margin-top: 3px;">ÏäπÏù∏ÎåÄÍ∏∞Ï§ë..</div>
                        <div th:if="${ChallengeMemberStatus < 0}" style="margin-left: 30px; color: #adadad; font-size: 17px; margin-top: 3px;">üë§</div>
                        <div th:if="${ChallengeMemberStatus < 0}" style="margin-left: 2px; color: #adadad; font-size: 17px; margin-top: 3px;">ÏÜêÎãò</div>
                    </div>

                    <br/>
                    <br/>
                    <br/>

                    <button class="chat-btn" th:if="${ChallengeMemberStatus == 1 or ChallengeMemberStatus == 2}"  id="chatRoom" onclick="chatRoom()">
                        <img src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Speech%20Balloon.png" alt="Speech Balloon" width="25px" height="25px" /> Ï±ÑÌåÖ Î∞îÎ°úÍ∞ÄÍ∏∞
                        <span class="notreadcount" name="room" th:attr="data-value=${roomId}">
                            -
                        </span>
                        <input type="hidden" id="ChallengeMemberStatus" name="ChallengeMemberStatus" th:value="${ChallengeMemberStatus}" />
                    </button>

                    <br/>
                    <h6><b>Challenge Record : </b><span th:text="${challengeDTO.challengeStartDate + ' ~ ' + challengeDTO.challengeEndDate}"></span> (Ï¥ù <span th:text="${challengeDay}"></span>Ïùº)</h5>

                        <div id="countdown-wrap" style="height: 100px;">
                            <div id="goal"></div>
                            <div id="glass">
                                <div id="progress">
                                </div>
                            </div>
                            <div class="goal-stat">
                                <span class="goal-number" id="current-amount" th:text="${userAuthCnt}"></span>
                                <span class="goal-label" style="width: fit-content;">ÌòÑÏû¨ Ïù∏Ï¶ù ÌöüÏàò</span>
                            </div>
                            <div class="goal-stat" style="margin-left: 140px; width: 31%;">
                                <span class="goal-number" style="text-align: right;" id="max-amount" th:text="${challengeDay}"></span>
                                <span class="goal-label">Ï±åÎ¶∞ÏßÄ Ï¥ù ÌöüÏàò</span>
                            </div>
                        </div>
                        <br/>
                    <div style="margin-top: 60px;">
                        <th:block th:unless="${#lists.isEmpty(authStatus)}">
                            <div th:each="authStatus : ${authStatus}" style="display: inline-block; align-content: center;">
                                <div th:if="${authStatus==0}" class="square gray"></div>
                                <div th:if="${authStatus==1}" class="square green"></div>
                            </div>
                        </th:block>
                    </div>
                </div>
                
            </div>




            <div class="col-8 mx-2 fixed-width-col">
    
                <div class="yj-img">
                    <img th:src="@{${'/image/challenge/challengeList/' + challengeDTO.challengeImageMain}}" alt="">
                    <div class="Main_content" >

                        <div class="round-image">
                                <img style="margin-bottom: 30px;" th:src="@{|/image/login/${masterInfoDTO.picture}|}" alt="">
                        </div>

                        <p class="Yj-master" th:text="${masterInfoDTO.email}"></p>
                        <p class="Yj-title" th:text="${challengeDTO.challengeTitle}"></p>
                        <div class="centered-content">
                            <div class="like-hitCount">
                                <img src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Smilies/Beating%20Heart.png" alt="Beating Heart" style="width: 30px; height: 30px;"/>
                                <div style="color: #383535; font-size: 17px;">Ï¢ãÏïÑÏöî
                                    <span style="color: red; font-weight: bold;" th:text="${challengeDTO.challengeLikeCount}">
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                  
                    <div class="main-text">
                        <p class="Yj-text1" th:utext="${challengeDTO.challengeContent.replaceAll('\n', '<br>')}"></p>
                        
                        <br/>
                        <br/>
                        <br/>
                        <br/>

                        <table>
                            <tr>
                                <td><i class="fa-solid fa-check" style="color: #e60f0f;"></i> Ïù∏Ï¶ù ÏÑ±Í≥µ ÏòàÏãú</td>
                                <td><i class="fa-solid fa-xmark" style="color: #e60f0f;"></i> Ïù∏Ï¶ù Ïã§Ìå® ÏòàÏãú</td>
                            </tr>
                            <tr style="width: 100%; height: 100%;">
                                
                                <td><img th:src="@{|/image/challenge/challengeList/${challengeDTO.challengeImageSuccess}|}" alt=""></td>
                                <td><img th:src="@{|/image/challenge/challengeList/${challengeDTO.challengeImageFail}|}" alt=""></td>
                            </tr>
                        </table>
                       



                        <div class="yj-info">ÏÉÅÏÑ∏ Ï†ïÎ≥¥</div>
                        <p class="text-with-hyphen Yj-text2">
                            Ïù∏Ï¶ù ÎπàÎèÑ : <span th:text="${challengeDTO.challengeWeekCheck}"></span>
                        </p>

                        <div th:if="${challengeDTO.challengeDateCheck}==1week">
                            <p class="text-with-hyphen Yj-text2">
                                Ïù∏Ï¶ù Í∏∞Í∞Ñ : 1Ï£ºÏùº ÎèôÏïà!
                            </p>
                        </div>
                        <div th:if="${challengeDTO.challengeDateCheck}==2week">
                            <p class="text-with-hyphen Yj-text2">
                                Ïù∏Ï¶ù Í∏∞Í∞Ñ : 2Ï£ºÏùº ÎèôÏïà!
                            </p>
                        </div>
                        <div th:if="${challengeDTO.challengeDateCheck}==3week">
                            <p class="text-with-hyphen Yj-text2">
                                Ïù∏Ï¶ù Í∏∞Í∞Ñ : 3Ï£ºÏùº ÎèôÏïà!
                            </p>
                        </div>
                        <div th:if="${challengeDTO.challengeDateCheck}==1month">
                            <p class="text-with-hyphen Yj-text2">
                                Ïù∏Ï¶ù Í∏∞Í∞Ñ : 1Îã¨ ÎèôÏïà!
                            </p>
                        </div>
                    
                        <p class="text-with-hyphen Yj-text2">
                            <span th:text="${challengeDTO.challengeStartDate}"></span> Î∂ÄÌÑ∞ <span th:text="${challengeDTO.challengeEndDate}"></span> ÍπåÏßÄ!
                        </p>

                        <div class="yj-inwon">ÌòÑÏû¨Ï∞∏Í∞Ä Ïù∏Ïõê</div>
                        <div class="text-container">
                            <p class="Yj-text3" th:text="${challengeDTO.challengeMemberCount}"></p>
                        </div>


                        


                        <div th:switch="${ChallengeMemberStatus != null and challengeDTO.challengeStatus == 1}">
                            <div th:case="true">
                                <div th:switch="${ChallengeMemberStatus}">

                                    <div th:case="-1">
                                        <form action="/joinChallenge.action" id="joinChallengeForm" method="post">
                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            <button type="button" class="join-button" onclick="joinChallenge();">
                                                Í∞ÄÏûÖÌïòÍ∏∞
                                            </button>
                                            <input type="hidden" name="challengeListNum" id="challengeListnum" th:value="${challengeDTO.challengeListNum}"/>
                                        </form>
                                    </div>

                                    <div th:case="1">
                                        <form action="/deleteChallenge.action" id="deleteChallengeForm" method="post">
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            <button type="button" class="delete-button" onclick="deleteChallenge();">
                                                Ï±åÎ¶∞ÏßÄ ÏÇ≠Ï†ú
                                            </button>
                                            <input type="hidden" name="challengeListNum" id="challengeListnum" th:value="${challengeDTO.challengeListNum}"/>
                                        </form>                           
                                    </div>

                                    <div th:case="2">
                                        <form action="/giveUpChallenge.action" id="giveUpChallengeForm" method="post">
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            <button type="button" class="out-button" onclick="giveUpChallenge();">
                                                Ï±åÎ¶∞ÏßÄ Ìè¨Í∏∞ÌïòÍ∏∞
                                            </button>
                                            <input type="hidden" name="challengeListNum" id="challengeListnum" th:value="${challengeDTO.challengeListNum}"/>
                                        </form>
                                    </div>

                                </div>
                            </div>
                            <div th:case="false">
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <button type="button" class="finish-button" disabled>
                                    ÎßàÍ∞êÎêú Ï±åÎ¶∞ÏßÄ
                                </button>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="meet-members">
                    <p style="margin-top: 10px; margin-bottom: 5px;">
                        <span style="margin-left: 12px;">Î©§Î≤ÑÎ™©Î°ù</span>
                        <span style="margin-left: 5px; color: #5CA8B5; font-weight: bold;" th:text="${challengeDTO.challengeMemberCount}"></span>
                        <span style="margin-right: 86px; color: #5CA8B5; font-weight: bold;">Î™Ö</span>
                    </p>
                <div div class="meet-mem-back">
                    <div class="meet-mem-list" th:each="challengeMember : ${lists}">
                        <li class="round-image-user mt-2" style="margin-right: 10px; margin-left: -10px;">
                            <img th:if="${challengeMember.role == 'GUEST'}" th:src="@{${challengeMember.picture}}">
                            <img th:if="${challengeMember.role != 'GUEST'}" th:src="@{image/login/__${challengeMember.picture}__}">
                        </li>
                        <li class="custom-li" th:text="${challengeMember.name}"></li>
                    </div>
                </div>
                </div>
            </div>
        </div>

    </div>

    <div class="yj-img2">
        <div class="review-title">Ïù∏Ï¶ù</div>
        <div class="review-sub">Ïù¥ Ï±åÎ¶∞ÏßÄÏóêÏÑú ÎãπÏã†Ïùò ÏÉùÏÉùÌïú ÌõÑÍ∏∞Î•º ÎÇ®Í≤®Î≥¥ÏÑ∏Ïöî!</div>


        <div>
            <div class="noStart" th:if="${ChallengeMemberStatus == 2 or ChallengeMemberStatus == 1}">ÏßÑÌñâÏ§ëÏù∏ Ï±åÎ¶∞ÏßÄÍ∞Ä ÏïÑÎãôÎãàÎã§.</div>
        </div>


        <div th:if="${challengeDTO.challengeStatus==1 && challengeStartBoolean==false}">
            <div class="review-write" th:if="${ChallengeMemberStatus == 2 or ChallengeMemberStatus == 1}">ÏûëÏÑ±ÌïòÍ∏∞</div>
        </div>

        <form action="uploadAuth" method="POST" enctype="multipart/form-data">
            <div class="review-form" style="display: none;">
                <div class="review-input">
                    <textarea name="challengeAuthContent" id="challengeAuthContent" placeholder=" Ï±åÎ¶∞ÏßÄ Ïù∏Ï¶ùÎÇ¥Ïö©ÏùÑ ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî."></textarea>
                    <input type="file" name="challengeAuthImage" id="challengeAuthImage" accept="image/*">
                    <input type="hidden" id="challengeListNum" name="challengeListNum" th:value="${challengeDTO.challengeListNum}" />
                    <button id="submit-review">Îì±Î°ùÌïòÍ∏∞</button>
                </div>
            </div>
        </form>

        <th:block th:if="${#lists.isEmpty(allReviewList)}">
            <div class="no-review">
                Îì±Î°ùÎêú Ï±åÎ¶∞ÏßÄ Ïù∏Ï¶ùÏù¥ ÏóÜÏäµÎãàÎã§.
            </div>
        </th:block>

        <th:block th:unless="${#lists.isEmpty(allReviewList)}">
            <div class="d-flex justify-content-center mb-4" th:each="allReviewList : ${allReviewList}">
                <div class="card" style="width: 36rem; margin-bottom: 20px; border:none;">
                    <div class="card-body">
                        <div class="d-flex flex-column mb-2">
                            <div class="round-image-user mt-2">
                                <img th:src="@{${'/image/login/' + allReviewList.picture}}" alt="Ïú†Ï†ÄÌîÑÏÇ¨(ÏûÑÏùò)"/>
                            </div>
                            <p class="memid" th:text="${allReviewList.email}"></p>
                            <div class="col-md-4 mx-auto" style="width: 300px; height: 300px; overflow: hidden; border-radius: 5px; margin-bottom: 10px; margin-top: 10px;">
                                <img th:src="@{${'/image/challenge/challengeCheck/' + allReviewList.challengeAuthImage}}" class="img-fluid rounded-start" alt="Î¶¨Î∑∞ÏÇ¨ÏßÑ" style="width: 100%; height: 100%; object-fit: cover; cursor: pointer;" onclick="openModal(this);">
                            </div>
                        </div>
                        
                            <div th:if="${ChallengeMemberStatus == 1 and allReviewList.challengeAuthStatus == 0}" style="text-align: center;" th:id="'selectAuth'+${allReviewList.challengeAuthImage}">
                                    <span style="display: inline-block;">
                                        <i class="fa-regular fa-circle-check" style="color: #008000;"></i>
                                    </span>
                                    <h5 style="display: inline; color: rgb(0, 128, 0); cursor: pointer;" th:data-challengeListNum="${allReviewList.challengeListNum}",
                                    th:data-challengeAuthImage="${allReviewList.challengeAuthImage}"
                                    onclick="confirmReview(
                                        this.getAttribute('data-challengeListNum'),
                                        this.getAttribute('data-challengeAuthImage'))">Ïù∏Ï¶ùÏäπÏù∏</h5>
&nbsp;&nbsp;&nbsp;&nbsp;
                                    <span style="display: inline-block;">
                                        <i class="fa-solid fa-triangle-exclamation" style="color: #ff0000;"></i>
                                    </span>
                                    <h5 style="display: inline; color: rgb(255, 0, 0); cursor: pointer;" th:data-challengeListNum="${allReviewList.challengeListNum}",
                                    th:data-challengeAuthImage="${allReviewList.challengeAuthImage}"
                                    onclick="failReview(
                                        this.getAttribute('data-challengeListNum'),
                                        this.getAttribute('data-challengeAuthImage'))">Ïù∏Ï¶ùÍ±∞Î∂Ä</h5>
                            </div>  
                    
                        <div th:id="'now'+${allReviewList.challengeAuthImage}">
                            <div th:if="${allReviewList.challengeAuthStatus==0}">
                                <span style="display: inline-block;">
                                    <i class="fa-solid fa-spinner" style="color: #929292;"></i>
                                </span>
                                <h5 style="display: inline; color: #929292;">Ïù∏Ï¶ùÏ§ë</h5>
                            </div>
                            <div th:if="${allReviewList.challengeAuthStatus==1}">
                                <span style="display: inline-block;">
                                    <i class="fa-regular fa-circle-check" style="color: #008000;"></i>
                                </span>
                                <h5 style="display: inline; color: rgb(0, 128, 0);">Ïù∏Ï¶ùÏôÑÎ£å!</h5>
                            </div>
                            <div th:if="${allReviewList.challengeAuthStatus==2}">
                                <span style="display: inline-block;">
                                    <i class="fa-solid fa-triangle-exclamation" style="color: #ff0000;"></i>
                                </span>
                                <h5 style="display: inline; color: rgb(255, 0, 0);">Ïù∏Ï¶ùÏã§Ìå®..</h5>
                            </div>
                        </div>


                        <div th:id="'confirm'+${allReviewList.challengeAuthImage}" style="display: none;">
                            <span style="display: inline-block;">
                                <i class="fa-regular fa-circle-check" style="color: #008000;"></i>
                            </span>
                            <h5 style="display: inline; color: rgb(0, 128, 0);">Ïù∏Ï¶ùÏôÑÎ£å!</h5>
                        </div>

                        <div th:id="'fail'+${allReviewList.challengeAuthImage}" style="display: none;">
                            <span style="display: inline-block;">
                                <i class="fa-solid fa-triangle-exclamation" style="color: #ff0000;"></i>
                            </span>
                            <h5 style="display: inline; color: rgb(255, 0, 0);">Ïù∏Ï¶ùÏã§Ìå®..</h5>
                        </div>
                       

                        <p class="card-text" th:text="${allReviewList.challengeAuthContent}" style="padding-left: 10px; padding-right: 10px; text-align: justify; font-size: 18px; margin-bottom: 5px;"></p>
                        
                        <p class="card-text d-flex" th:text="${allReviewList.challengeAuthCreateDate}" style="color: #AAAAAA; font-size: 13px; position: absolute; top: 0; right: 0; margin-top: 31px; margin-right: 20px;"></p>

                        <span class="card-text d-flex delete-review" style="color: #AAAAAA; font-size: 13px; position: absolute; top: 0; right: 0; margin-top: 50px; margin-right: 20px;" 
                        th:if="${allReviewList.email == challengeInfoDTO.email}" 
                        th:data-email="${allReviewList.email}" 
                        th:data-challengeListNum="${allReviewList.challengeListNum}" 
                        th:data-challengeAuthListNum="${allReviewList.challengeAuthListNum}",
                        th:data-challengeAuthImage="${allReviewList.challengeAuthImage}"

                        onclick="deleteReview(
                            this.getAttribute('data-email'), 
                            this.getAttribute('data-challengeListNum'), 
                            this.getAttribute('data-challengeAuthListNum'),
                            this.getAttribute('data-challengeAuthImage'))">ÏÇ≠Ï†ú</span>

                    </div>
                </div>
            </div>
        </th:block>

    </div>






        
</div>

</body>
</html>